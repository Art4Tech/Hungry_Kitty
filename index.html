<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hungry Kitty: A Visual Tale</title>
    <style>
        :root {
            --bg-city: linear-gradient(to bottom, #2c3e50, #3498db);
            --bg-forest: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
            --bg-snow: linear-gradient(to bottom, #83a4d4, #b6fbff);
            --bg-cabin: linear-gradient(to bottom, #4b1208, #852913);
        }

        body {
            margin: 0;
            overflow: hidden;
            background: #111;
            font-family: 'Georgia', serif;
            color: white;
            user-select: none;
        }

        /* --- THE STAGE (3D CONTAINER) --- */
        #stage {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            perspective: 1000px; /* Creates 3D depth */
            cursor: crosshair;
        }

        /* PARALLAX LAYERS */
        .layer {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            transition: transform 0.1s ease-out;
            display: flex;
            justify-content: center;
            align-items: center;
            pointer-events: none; /* Let clicks pass through unless specific item */
        }

        /* Background Layer (Sky/Atmosphere) */
        #layer-bg { z-index: 1; transform: scale(1.1); }
        
        /* Midground (Environment/Buildings/Trees) */
        #layer-mid { z-index: 2; }
        
        /* Foreground (Immediate obstacles, Bushes) */
        #layer-fore { z-index: 3; }

        /* UI Layer (HUD, Text) */
        #layer-ui { 
            z-index: 10; 
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 40px;
            box-sizing: border-box;
        }

        /* --- GAME OBJECTS (CSS ART) --- */
        .interactable {
            pointer-events: auto;
            cursor: pointer;
            transition: transform 0.2s, filter 0.2s;
        }
        .interactable:hover {
            transform: scale(1.1);
            filter: drop-shadow(0 0 10px gold);
        }

        /* Treat Item */
        .item-treat {
            font-size: 3rem;
            animation: float 3s infinite ease-in-out;
        }

        /* Enemy (The Dog) */
        .enemy {
            position: absolute;
            font-size: 15rem;
            filter: drop-shadow(0 0 20px black);
            transition: opacity 1s;
            opacity: 0; /* Hidden by default */
        }
        .enemy.active { opacity: 1; }

        /* --- UI ELEMENTS --- */
        #story-text {
            background: rgba(0,0,0,0.7);
            padding: 20px;
            border-radius: 10px;
            max-width: 600px;
            text-align: center;
            line-height: 1.6;
            font-size: 1.2rem;
            margin: 0 auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            pointer-events: auto;
        }

        #hud-stats {
            display: flex;
            gap: 20px;
            font-size: 1.5rem;
            text-shadow: 0 2px 4px black;
        }

        #choices {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 20px;
            pointer-events: auto;
        }

        .btn {
            background: linear-gradient(45deg, #6c5ce7, #a29bfe);
            border: none;
            padding: 10px 20px;
            color: white;
            border-radius: 5px;
            font-family: inherit;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 4px 0 #5f27cd;
        }
        .btn:active { transform: translateY(4px); box-shadow: none; }
        .btn:disabled { background: #555; box-shadow: none; cursor: not-allowed; }

        /* ANIMATIONS */
        @keyframes float { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-15px);} }
        
        /* VISUAL STYLES FOR BIOMES */
        .scene-city { background: var(--bg-city); }
        .scene-forest { background: var(--bg-forest); }
        .scene-snow { background: var(--bg-snow); }
        .scene-cabin { background: var(--bg-cabin); }

    </style>
</head>
<body>

    <div id="stage">
        <div id="layer-bg" class="layer"></div>

        <div id="layer-mid" class="layer"></div>

        <div id="layer-fore" class="layer"></div>

        <div id="layer-ui" class="layer">
            <div id="hud-stats">
                <span id="hud-treats">üêü 0/15</span>
                <span id="hud-location">üìç City Streets</span>
            </div>

            <div id="story-container">
                <div id="story-text">
                    <h1>Hungry Kitty: The Journey</h1>
                    <p>You are hungry. The city is loud. The wild calls.</p>
                    <p>Click <b>Start</b> to begin your hunt.</p>
                    <br>
                    <button class="btn" onclick="game.start()">Wake Up</button>
                </div>
                <div id="choices"></div>
            </div>
            
            <div style="font-size:0.8rem; opacity:0.5;">Created by Arthur Fedderson ¬© Art4Tech 2025</div>
        </div>
    </div>

<script>
/**
 * HUNGRY KITTY VISUAL ENGINE
 * Uses CSS 3D Transforms for parallax and DOM manipulation for storytelling.
 */

const game = {
    state: {
        treats: 0,
        maxTreats: 15,
        currentBiome: 0, // 0:City, 1:Forest, 2:Snow, 3:Cabin
        isHiding: false,
        dogActive: false
    },

    biomes: [
        {
            id: 'city',
            name: 'Neon City',
            desc: "The alleyway is cold. Trash cans rattle in the wind. You smell fish nearby.",
            bgHTML: '<div style="font-size:20rem; opacity:0.3; transform:translateY(50px)">üèôÔ∏è</div>',
            midHTML: '<div style="font-size:10rem; margin-left:-300px">üóëÔ∏è</div><div style="font-size:12rem; margin-left:300px">üöí</div>',
            foreHTML: '<div style="font-size:15rem; margin-top:400px; margin-left:-500px; filter:blur(2px)">üß±</div>',
            dog: 'üê∂', // Pug
            treats: ['üêü','ü¶¥','üßÄ']
        },
        {
            id: 'forest',
            name: 'Whispering Woods',
            desc: "The city fades. Tall pines block the sky. A twig snaps nearby...",
            bgHTML: '<div style="font-size:25rem; opacity:0.4;">üå≤üå≤üå≤</div>',
            midHTML: '<div style="font-size:12rem; margin-left:-400px">üå≤</div><div style="font-size:8rem; margin-left:200px">üçÑ</div>',
            foreHTML: '<div style="font-size:18rem; margin-top:300px; margin-right:-400px; filter:blur(3px)">üåø</div>',
            dog: 'üê∫', // Wolf
            treats: ['üê¶','ü¶ó','üêü']
        },
        {
            id: 'snow',
            name: 'Frozen Peaks',
            desc: "The air bites your nose. The snow is deep. You see paw prints that are not yours.",
            bgHTML: '<div style="font-size:30rem; opacity:0.5; color:white;">üèîÔ∏è</div>',
            midHTML: '<div style="font-size:10rem; margin-left:-200px">‚ùÑÔ∏è</div><div style="font-size:12rem; margin-left:400px">üéÑ</div>',
            foreHTML: '<div style="font-size:20rem; margin-top:400px; filter:blur(4px); opacity:0.8">üå®Ô∏è</div>',
            dog: 'üêï‚Äçü¶∫', // Husky
            treats: ['üêü','üßä','ü•©']
        }
    ],

    // --- INITIALIZATION ---
    init: function() {
        // Parallax Logic
        document.addEventListener('mousemove', (e) => {
            const x = (window.innerWidth - e.pageX * 2) / 100;
            const y = (window.innerHeight - e.pageY * 2) / 100;

            // Apply shifts (Background moves slow, Foreground moves fast)
            document.getElementById('layer-bg').style.transform = `translate(${x}px, ${y}px) scale(1.1)`;
            document.getElementById('layer-mid').style.transform = `translate(${x*2}px, ${y*2}px)`;
            document.getElementById('layer-fore').style.transform = `translate(${x*4}px, ${y*4}px)`;
        });
    },

    start: function() {
        this.audio.init();
        this.loadScene(0);
    },

    // --- SCENE MANAGER ---
    loadScene: function(index) {
        this.state.currentBiome = index;
        const biome = this.biomes[index];
        const stage = document.getElementById('stage');

        // 1. Set Visuals
        stage.className = `scene-${biome.id}`;
        document.getElementById('layer-bg').innerHTML = biome.bgHTML;
        document.getElementById('layer-mid').innerHTML = biome.midHTML;
        document.getElementById('layer-fore').innerHTML = biome.foreHTML;
        
        // 2. Set Text
        this.ui.updateText(biome.name, biome.desc);
        document.getElementById('hud-location').innerText = "üìç " + biome.name;

        // 3. Spawn Treats (Interactive Elements)
        this.spawnTreats(biome);

        // 4. Audio Change
        this.audio.playTheme(biome.id);

        // 5. Random Event Trigger (Dog Encounter)
        this.state.dogActive = false;
        setTimeout(() => {
            if(Math.random() > 0.3) this.triggerDogEncounter(biome);
        }, 2000);
    },

    spawnTreats: function(biome) {
        const layer = document.getElementById('layer-mid');
        // Add clickable treats
        for(let i=0; i<3; i++) {
            const el = document.createElement('div');
            el.innerHTML = biome.treats[i];
            el.className = 'interactable item-treat';
            el.style.position = 'absolute';
            el.style.left = (20 + Math.random()*60) + '%';
            el.style.top = (40 + Math.random()*40) + '%';
            
            el.onclick = (e) => {
                if(this.state.dogActive) return; // Can't eat while hunted
                e.target.remove();
                this.collectTreat();
            };
            layer.appendChild(el);
        }
    },

    collectTreat: function() {
        this.state.treats++;
        this.ui.updateHUD();
        this.audio.playSFX('crunch');
        
        // Check Progression
        if(this.state.treats === 5) {
            this.ui.showChoice("You are getting full.", "Move to Forest", () => this.loadScene(1));
        } else if (this.state.treats === 10) {
            this.ui.showChoice("The air is getting colder.", "Climb Mountain", () => this.loadScene(2));
        } else if (this.state.treats >= 15) {
            this.triggerWin();
        }
    },

    // --- DOG ENCOUNTER SYSTEM ---
    triggerDogEncounter: function(biome) {
        this.state.dogActive = true;
        
        // Visuals
        const dogEl = document.createElement('div');
        dogEl.className = 'enemy active';
        dogEl.innerHTML = biome.dog;
        dogEl.style.left = '50%';
        dogEl.style.top = '50%';
        dogEl.style.transform = 'translate(-50%, -50%)';
        document.getElementById('layer-fore').appendChild(dogEl);

        // Audio
        this.audio.playSFX('bark');

        // Text
        this.ui.updateText("DANGER!", `A wild ${biome.id === 'city' ? 'Pug' : 'Wolf'} appears! It sniffs the air.`);

        // Choices
        const choices = document.getElementById('choices');
        choices.innerHTML = '';
        
        const btnHide = document.createElement('button');
        btnHide.className = 'btn';
        btnHide.innerText = "Hide in Bush üåø";
        btnHide.onclick = () => this.resolveEncounter('hide', dogEl);
        
        const btnRun = document.createElement('button');
        btnRun.className = 'btn';
        btnRun.innerText = "Run Away ‚ö°";
        btnRun.onclick = () => this.resolveEncounter('run', dogEl);

        choices.appendChild(btnHide);
        choices.appendChild(btnRun);
    },

    resolveEncounter: function(action, dogEl) {
        const success = Math.random() > 0.3; // 70% success rate
        
        if(success) {
            this.ui.updateText("Safe!", "You escaped the dog.");
            dogEl.style.opacity = 0;
            setTimeout(() => dogEl.remove(), 1000);
            this.state.dogActive = false;
            document.getElementById('choices').innerHTML = ''; // Clear buttons
        } else {
            this.triggerFail();
        }
    },

    triggerFail: function() {
        document.body.style.background = 'black';
        document.getElementById('stage').style.display = 'none';
        alert("CAUGHT! The dog was too fast. Refresh to try again.");
        location.reload();
    },

    triggerWin: function() {
        document.getElementById('layer-bg').innerHTML = '<div style="font-size:30rem; opacity:0.2;">üè†</div>';
        this.ui.updateText("KITTY VALHALLA", "You reached the cabin! You share your 15 treats with the puppy and sleep by the fire. <br><br><b>THE END</b>");
        document.getElementById('choices').innerHTML = '<button class="btn" onclick="location.reload()">Replay</button>';
        this.audio.playTheme('cabin');
    },

    // --- UI HELPER ---
    ui: {
        updateText: function(title, body) {
            const container = document.getElementById('story-text');
            container.innerHTML = `<h2>${title}</h2><p>${body}</p>`;
        },
        updateHUD: function() {
            document.getElementById('hud-treats').innerText = `üêü ${game.state.treats}/${game.state.maxTreats}`;
        },
        showChoice: function(text, btnLabel, callback) {
            const c = document.getElementById('choices');
            c.innerHTML = `<p style="width:100%">${text}</p>`;
            const btn = document.createElement('button');
            btn.className = 'btn';
            btn.innerText = btnLabel;
            btn.onclick = callback;
            c.appendChild(btn);
        }
    },

    // --- AUDIO ENGINE (Web Audio API) ---
    audio: {
        ctx: null,
        osc: null,
        
        init: function() {
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            this.ctx = new AudioContext();
            this.master = this.ctx.createGain();
            this.master.gain.value = 0.3;
            this.master.connect(this.ctx.destination);
        },

        playTheme: function(type) {
            if(!this.ctx) return;
            // Simple ambient drone generation
            if(this.osc) this.osc.stop();
            
            this.osc = this.ctx.createOscillator();
            this.osc.type = 'triangle';
            
            if(type === 'city') this.osc.frequency.value = 100; // Low hum
            if(type === 'forest') this.osc.frequency.value = 150; // Mid nature
            if(type === 'snow') this.osc.frequency.value = 200; // High wind
            if(type === 'cabin') this.osc.frequency.value = 220; // Warm A3

            // LFO for wobble (Lofi feel)
            const lfo = this.ctx.createOscillator();
            lfo.frequency.value = 0.5;
            const lfoGain = this.ctx.createGain();
            lfoGain.gain.value = 5;
            lfo.connect(lfoGain);
            lfoGain.connect(this.osc.frequency);
            lfo.start();

            this.osc.connect(this.master);
            this.osc.start();
        },

        playSFX: function(type) {
            if(!this.ctx) return;
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.connect(gain);
            gain.connect(this.ctx.destination);

            if(type === 'crunch') {
                osc.type = 'square';
                osc.frequency.setValueAtTime(600, this.ctx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(100, this.ctx.currentTime + 0.1);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.linearRampToValueAtTime(0, this.ctx.currentTime + 0.1);
                osc.start(); osc.stop(this.ctx.currentTime + 0.1);
            } else if (type === 'bark') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(200, this.ctx.currentTime);
                osc.frequency.linearRampToValueAtTime(100, this.ctx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.3, this.ctx.currentTime);
                gain.gain.linearRampToValueAtTime(0, this.ctx.currentTime + 0.2);
                osc.start(); osc.stop(this.ctx.currentTime + 0.2);
            }
        }
    }
};

// Start listening for mouse movement immediately
game.init();

</script>
</body>
</html>